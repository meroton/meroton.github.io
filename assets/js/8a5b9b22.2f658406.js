"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[5650],{5945:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>s,contentTitle:()=>r,default:()=>u,frontMatter:()=>o,metadata:()=>l,toc:()=>c});var i=t(4848),a=t(8453);const o={slug:"bb-deploy-updates-2022-04",title:"Updates to Buildbarn deployment repo as of April 2022",authors:"benjamin",tags:["release","buildbarn"]},r="Updates to Buildbarn April 2022",l={permalink:"/blog/bb-deploy-updates-2022-04",editUrl:"https://github.com/meroton/docs/edit/main/blog/2022-05-04-updates-to-bb-deploy.mdx",source:"@site/blog/2022-05-04-updates-to-bb-deploy.mdx",title:"Updates to Buildbarn deployment repo as of April 2022",description:"The sample configuration project for Buildbarn was recently updated after a long hiatus. As an aid for people to understand which changes have been done see the following high level summary.",date:"2022-05-04T00:00:00.000Z",tags:[{inline:!0,label:"release",permalink:"/blog/tags/release"},{inline:!0,label:"buildbarn",permalink:"/blog/tags/buildbarn"}],readingTime:1.63,hasTruncateMarker:!1,authors:[{name:"Benjamin Ingberg",imageURL:"/img/benjamin-avatar.png",key:"benjamin",page:null}],frontMatter:{slug:"bb-deploy-updates-2022-04",title:"Updates to Buildbarn deployment repo as of April 2022",authors:"benjamin",tags:["release","buildbarn"]},unlisted:!1,prevItem:{title:"Tips, Tricks & Non-Deterministic Builds",permalink:"/blog/tips-trix-and-nondeterminism"},nextItem:{title:"Purpose of the Articles",permalink:"/blog/about"}},s={authorsImageUrls:[void 0]},c=[{value:"April 2022 Updates",id:"april-2022-updates",level:2},{value:"Authorizer Overhaul",id:"authorizer-overhaul",level:3},{value:"Hierarchical Blob Access",id:"hierarchical-blob-access",level:3},{value:"Action Result Expiration",id:"action-result-expiration",level:3},{value:"Read Only Cache Replicas",id:"read-only-cache-replicas",level:3},{value:"Concurrency Limiting Blob Replication",id:"concurrency-limiting-blob-replication",level:3},{value:"Run Commands as Another User",id:"run-commands-as-another-user",level:3},{value:"Size Class Analysis",id:"size-class-analysis",level:3},{value:"Execution Routing Policy",id:"execution-routing-policy",level:3}];function d(e){const n={a:"a",code:"code",h2:"h2",h3:"h3",p:"p",...(0,a.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.a,{href:"https://github.com/buildbarn/bb-deployments",children:"sample configuration project for Buildbarn"})," was recently updated after a long hiatus. As an aid for people to understand which changes have been done see the following high level summary."]}),"\n",(0,i.jsx)(n.h2,{id:"april-2022-updates",children:"April 2022 Updates"}),"\n",(0,i.jsx)(n.p,{children:"This includes updates to Buildbarn since December 2020."}),"\n",(0,i.jsx)(n.h3,{id:"authorizer-overhaul",children:"Authorizer Overhaul"}),"\n",(0,i.jsx)(n.p,{children:"Authorizers have been rehauled to be more flexible it is now part of each individual cache and execution configuration."}),"\n",(0,i.jsx)(n.p,{children:"Using a JWT authorization bearer token has been added as an authorization method."}),"\n",(0,i.jsx)(n.h3,{id:"hierarchical-blob-access",children:"Hierarchical Blob Access"}),"\n",(0,i.jsxs)(n.p,{children:["Using hierarchical blob access allows blobs in instance name ",(0,i.jsx)(n.code,{children:"foo/bar"})," to be accessed from instance ",(0,i.jsx)(n.code,{children:"foo/bar/baz"})," but not instance ",(0,i.jsx)(n.code,{children:"foo"})," or ",(0,i.jsx)(n.code,{children:"foo/qux"}),"."]}),"\n",(0,i.jsx)(n.h3,{id:"action-result-expiration",children:"Action Result Expiration"}),"\n",(0,i.jsx)(n.p,{children:"An expiry can be added to action result which lets the action cache purge the result of an exection that was performed too far in the past. This can be used to ensure that all targets are rebuilt periodically even if they are accessed frequently enough to not normally be purged from the cache."}),"\n",(0,i.jsx)(n.h3,{id:"read-only-cache-replicas",children:"Read Only Cache Replicas"}),"\n",(0,i.jsx)(n.p,{children:"Cache read traffic can now be sent to a read-only replica which is periodically probed for availability."}),"\n",(0,i.jsx)(n.h3,{id:"concurrency-limiting-blob-replication",children:"Concurrency Limiting Blob Replication"}),"\n",(0,i.jsx)(n.p,{children:"Limit the number of concurrent replications to prevent network starvation"}),"\n",(0,i.jsx)(n.h3,{id:"run-commands-as-another-user",children:"Run Commands as Another User"}),"\n",(0,i.jsx)(n.p,{children:"Allows the commands to be run as a different user, on most platforms this means the bb-runner instance must run as root."}),"\n",(0,i.jsx)(n.h3,{id:"size-class-analysis",children:"Size Class Analysis"}),"\n",(0,i.jsx)(n.p,{children:"Allows executors of different size classes to be used, the scheduler will attempt to utilize executors efficiently but there is an inherent tradeof between throughput and latency. Once configured the scheduler will automatically attempt to keep track of which actions are best run on which executors."}),"\n",(0,i.jsx)(n.h3,{id:"execution-routing-policy",children:"Execution Routing Policy"}),"\n",(0,i.jsx)(n.p,{children:"The scheduler accepts an execution routing policy configuration that allows it to determine how to defer builds to different executors."}),"\n",(0,i.jsx)(n.p,{children:"If you see any other changes you feel should get a mention feel free to submit a pull request at github using the link below."})]})}function u(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>r,x:()=>l});var i=t(6540);const a={},o=i.createContext(a);function r(e){const n=i.useContext(o);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:r(e.components),i.createElement(o.Provider,{value:n},e.children)}}}]);