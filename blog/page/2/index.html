<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-list-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.5.2">
<title data-rh="true">Meroton Blog | Meroton</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://meroton.github.io/blog/page/2/"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" property="og:title" content="Meroton Blog | Meroton"><meta data-rh="true" name="description" content="Free form articles describing technical issues, solutions and news from meroton"><meta data-rh="true" property="og:description" content="Free form articles describing technical issues, solutions and news from meroton"><meta data-rh="true" name="docusaurus_tag" content="blog_posts_list"><meta data-rh="true" name="docsearch:docusaurus_tag" content="blog_posts_list"><link data-rh="true" rel="icon" href="/img/favicon.svg"><link data-rh="true" rel="canonical" href="https://meroton.github.io/blog/page/2/"><link data-rh="true" rel="alternate" href="https://meroton.github.io/blog/page/2/" hreflang="en"><link data-rh="true" rel="alternate" href="https://meroton.github.io/blog/page/2/" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"Blog","@id":"https://meroton.github.io/blog/page/2","mainEntityOfPage":"https://meroton.github.io/blog/page/2","headline":"Meroton Blog","description":"Free form articles describing technical issues, solutions and news from meroton","blogPost":[{"@type":"BlogPosting","@id":"https://meroton.github.io/blog/bb-deployments-updates-2023-02","mainEntityOfPage":"https://meroton.github.io/blog/bb-deployments-updates-2023-02","url":"https://meroton.github.io/blog/bb-deployments-updates-2023-02","headline":"Updates to Buildbarn deployment repo as of Febuary 2023","name":"Updates to Buildbarn deployment repo as of Febuary 2023","description":"The example configuration project for buildbarn","datePublished":"2023-02-21T00:00:00.000Z","author":{"@type":"Person","name":"Benjamin Ingberg","image":"/img/benjamin-avatar.png"},"keywords":[]},{"@type":"BlogPosting","@id":"https://meroton.github.io/blog/bazel-6-errors-build-without-the-bytes","mainEntityOfPage":"https://meroton.github.io/blog/bazel-6-errors-build-without-the-bytes","url":"https://meroton.github.io/blog/bazel-6-errors-build-without-the-bytes","headline":"Bazel 6 Errors when using Build without the Bytes","name":"Bazel 6 Errors when using Build without the Bytes","description":"_ UPDATE:  Bazel has a workaround for this issue","datePublished":"2023-02-07T00:00:00.000Z","author":{"@type":"Person","name":"Benjamin Ingberg","image":"/img/benjamin-avatar.png"},"keywords":[]},{"@type":"BlogPosting","@id":"https://meroton.github.io/blog/buildbar-at-meroton-office","mainEntityOfPage":"https://meroton.github.io/blog/buildbar-at-meroton-office","url":"https://meroton.github.io/blog/buildbar-at-meroton-office","headline":"BuildBar at the Meroton Office","name":"BuildBar at the Meroton Office","description":"After BazelCon we've all gotten a bit giddy and you might feel excited how the information presented at BazelCon might impact your development workflow.","datePublished":"2022-11-24T00:00:00.000Z","author":{"@type":"Person","name":"Benjamin Ingberg","image":"/img/benjamin-avatar.png"},"keywords":[]},{"@type":"BlogPosting","@id":"https://meroton.github.io/blog/remote-executors-for-free-tier","mainEntityOfPage":"https://meroton.github.io/blog/remote-executors-for-free-tier","url":"https://meroton.github.io/blog/remote-executors-for-free-tier","headline":"Remote Executors for the Free Environment","name":"Remote Executors for the Free Environment","description":"We've performed some updates to the free tier and our pricing model.","datePublished":"2022-10-13T00:00:00.000Z","author":{"@type":"Person","name":"Benjamin Ingberg","image":"/img/benjamin-avatar.png"},"keywords":[]},{"@type":"BlogPosting","@id":"https://meroton.github.io/blog/tips-trix-and-nondeterminism","mainEntityOfPage":"https://meroton.github.io/blog/tips-trix-and-nondeterminism","url":"https://meroton.github.io/blog/tips-trix-and-nondeterminism","headline":"Tips, Tricks & Non-Deterministic Builds","name":"Tips, Tricks & Non-Deterministic Builds","description":"When you have a remote build and cache cluster it can sometimes be hard to track down what exactly is using all of your building resources. To help with this we have started a tips and trix section in the documentation where we will share methods we use to debug and resolve slow builds.","datePublished":"2022-08-28T00:00:00.000Z","author":{"@type":"Person","name":"Benjamin Ingberg","image":"/img/benjamin-avatar.png"},"keywords":[]},{"@type":"BlogPosting","@id":"https://meroton.github.io/blog/bb-deploy-updates-2022-04","mainEntityOfPage":"https://meroton.github.io/blog/bb-deploy-updates-2022-04","url":"https://meroton.github.io/blog/bb-deploy-updates-2022-04","headline":"Updates to Buildbarn deployment repo as of April 2022","name":"Updates to Buildbarn deployment repo as of April 2022","description":"The sample configuration project for Buildbarn was recently updated after a long hiatus. As an aid for people to understand which changes have been done see the following high level summary.","datePublished":"2022-05-04T00:00:00.000Z","author":{"@type":"Person","name":"Benjamin Ingberg","image":"/img/benjamin-avatar.png"},"keywords":[]},{"@type":"BlogPosting","@id":"https://meroton.github.io/blog/about","mainEntityOfPage":"https://meroton.github.io/blog/about","url":"https://meroton.github.io/blog/about","headline":"Purpose of the Articles","name":"Purpose of the Articles","description":"The purpose of these articles is to have a freeform area discussing ideas, technical issues, solutions and news in an indepth relaxed manner. It is not to serve as reference material, structured reference material should be available in the documentation section.","datePublished":"2022-02-22T00:00:00.000Z","author":{"@type":"Person","name":"Benjamin Ingberg","image":"/img/benjamin-avatar.png"},"keywords":[]}]}</script><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title=" RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title=" Atom Feed">
<link rel="alternate" type="application/json" href="/blog/feed.json" title=" JSON Feed">



<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-LVF8V72WEQ"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-LVF8V72WEQ",{anonymize_ip:!0})</script><link rel="stylesheet" href="/assets/css/styles.c773db27.css">
<script src="/assets/js/runtime~main.b4697178.js" defer="defer"></script>
<script src="/assets/js/main.0e82f26d.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="Meroton" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="Meroton" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Meroton</b></a><a class="navbar__item navbar__link" href="/docs/intro/">Documentation</a><a class="navbar__item navbar__link" href="/services/">Services</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog/">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://forms.gle/wchwDu6roWg6A7U29" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Sign up<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">All articles</div><div role="group"><h3 class="yearGroupHeading_rMGB">2025</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/bazel-buildbarn-and-bonanza/">Bazel, Buildbarn and Bonanza</a></li></ul></div><div role="group"><h3 class="yearGroupHeading_rMGB">2024</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/understanding-the-klm/">Understanding the KLM</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/introducing-buildbarn-fundamentals/">Introducing Meroton’s New Course: Buildbarn Fundamentals</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/summer-buildbar-2024/">Summer Buildbar</a></li></ul></div><div role="group"><h3 class="yearGroupHeading_rMGB">2023</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/Automatically-reformat-all-commits-on-a-branch/">Automatically Reformat all Commits on a Branch</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/improved-chroot-in-buildbarn/">Improved Chroot in Buildbarn</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/buildbarn-updates-2023-11/">Updates to Buildbarn as of November 2023</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/memory-adventure/">Memory Adventure</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/bazelcon-2023/">BazelCon 2023</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/buildbarn-block-sizes/">Buildbarn Block Sizes</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/bb-deployments-updates-2023-02/">Updates to Buildbarn deployment repo as of Febuary 2023</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/bazel-6-errors-build-without-the-bytes/">Bazel 6 Errors when using Build without the Bytes</a></li></ul></div><div role="group"><h3 class="yearGroupHeading_rMGB">2022</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/buildbar-at-meroton-office/">BuildBar at the Meroton Office</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/remote-executors-for-free-tier/">Remote Executors for the Free Environment</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/tips-trix-and-nondeterminism/">Tips, Tricks &amp; Non-Deterministic Builds</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/bb-deploy-updates-2022-04/">Updates to Buildbarn deployment repo as of April 2022</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/about/">Purpose of the Articles</a></li></ul></div></nav></aside><main class="col col--7"><article class="margin-bottom--xl"><header><h2 class="title_f1Hy"><a href="/blog/bb-deployments-updates-2023-02/">Updates to Buildbarn deployment repo as of Febuary 2023</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2023-02-21T00:00:00.000Z">February 21, 2023</time> · <!-- -->4 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><img class="avatar__photo authorImage_XqGP" src="/img/benjamin-avatar.png" alt="Benjamin Ingberg"><div class="avatar__intro authorDetails_lV9A"><div class="avatar__name"><span class="authorName_yefp">Benjamin Ingberg</span></div><div class="authorSocials_rSDt"></div></div></div></div></div></header><div class="markdown"><p>The example configuration project for buildbarn
<a href="https://github.com/buildbarn/bb-deployments" target="_blank" rel="noopener noreferrer">bb-deployments</a>
has gotten updates.</p>
<p>This is a continuation of the
<a href="/blog/bb-deploy-updates-2022-04/">updates from last year article</a>
and is a high level summary of what has happened since April 2022 up to 2023-02-16.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="let-referenceexpandingblobaccess-support-gcs">Let ReferenceExpandingBlobAccess support GCS<a href="#let-referenceexpandingblobaccess-support-gcs" class="hash-link" aria-label="Direct link to Let ReferenceExpandingBlobAccess support GCS" title="Direct link to Let ReferenceExpandingBlobAccess support GCS">​</a></h2>
<p>ReferenceExpandingBlobAccess already supports S3 so support was extended to Google Cloud Storage buckets.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="support-for-prefetching-virtual-filesystems">Support for prefetching Virtual Filesystems<a href="#support-for-prefetching-virtual-filesystems" class="hash-link" aria-label="Direct link to Support for prefetching Virtual Filesystems" title="Direct link to Support for prefetching Virtual Filesystems">​</a></h2>
<p>Running workers with Fuse allows inputs for an action
to be downloaded on demand.
This significantly reduces the amount of data
that gets sent in order to run overspecified actions.
This however leads to poor performance for actions
which reads a lot of their inputs synchronously.</p>
<p>With the prefetcher most of these actions can be recognized
and data which is likely to be needed
can be downloaded ahead of time.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="support-for-sha256tree">Support for sha256tree<a href="#support-for-sha256tree" class="hash-link" aria-label="Direct link to Support for sha256tree" title="Direct link to Support for sha256tree">​</a></h2>
<p>Buildbarn has added support for
<a href="https://github.com/bazelbuild/remote-apis/pull/235" target="_blank" rel="noopener noreferrer">sha256tree</a>
which uses sha256 hashing over a tree structure similar to blake3.</p>
<p>This algorithm will allow large CAS objects to be chunked and decompositioned
with guaranteed data integrity while still using sha256 hardware instructions.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="completeness-checking-now-streams-rev2-tree-objects">Completeness checking now streams REv2 Tree objects<a href="#completeness-checking-now-streams-rev2-tree-objects" class="hash-link" aria-label="Direct link to Completeness checking now streams REv2 Tree objects" title="Direct link to Completeness checking now streams REv2 Tree objects">​</a></h2>
<p>This change introduces a small change to the configuration schema. If you previous had this:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">backend: { completenessChecking: ... },</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You will now need to write something along these lines:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">backend: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    completenessChecking: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        backend: ...,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        maximumTotalTreeSizeBytes: 64 * 1024 * 1024,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">},</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>See also the
<a href="https://github.com/buildbarn/bb-storage/commit/1b84fa824dc60e77776ce50e05c549fdf20c089b" target="_blank" rel="noopener noreferrer">bb-storage commit 1b84fa8</a>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="postponed-healthy-service-status">Postponed healthy service status<a href="#postponed-healthy-service-status" class="hash-link" aria-label="Direct link to Postponed healthy service status" title="Direct link to Postponed healthy service status">​</a></h2>
<p>The healthy and serving status,
i.e. HTTP <code>/-/healthy</code> and
<a href="https://pkg.go.dev/google.golang.org/grpc/health/grpc_health_v1#HealthCheckResponse_ServingStatus" target="_blank" rel="noopener noreferrer">grpc_health_v1.HealthCheckResponse_SERVING</a>,
are now postponed until the whole service is up and running.
Before, the healthy status was potentially reported before starting to listen to the gRPC ports.
Kubernetes will now wait until the service is up before forwarding connections to it.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="server-keepalive-parameter-options">Server keepalive parameter options<a href="#server-keepalive-parameter-options" class="hash-link" aria-label="Direct link to Server keepalive parameter options" title="Direct link to Server keepalive parameter options">​</a></h2>
<p>The option <code>buildbarn.configuration.grpc.ServerConfiguration.keepalive_parameters</code> can be used for L4 load balancing,
to control when to ask clients to reconnect.
For default values, see
<a href="https://pkg.go.dev/google.golang.org/grpc@v1.49.0/keepalive#ServerParameters" target="_blank" rel="noopener noreferrer">keepalive.ServerParameters</a>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="graceful-termination-of-localblobaccess">Graceful termination of <code>LocalBlobAccess</code><a href="#graceful-termination-of-localblobaccess" class="hash-link" aria-label="Direct link to graceful-termination-of-localblobaccess" title="Direct link to graceful-termination-of-localblobaccess">​</a></h2>
<p>When <code>SIGTERM</code> or <code>SIGINT</code> is received, the <code>LocalBlobAccess</code> now synchronize data to disk before shutting down.
Deployments using persistent storage will no longer observe loss of data when restarting the <code>bb_storage</code> services.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="non-sector-aligned-writes-to-block-device">Non-sector Aligned Writes to Block Device<a href="#non-sector-aligned-writes-to-block-device" class="hash-link" aria-label="Direct link to Non-sector Aligned Writes to Block Device" title="Direct link to Non-sector Aligned Writes to Block Device">​</a></h2>
<p>Using sector aligned storage is wasteful for the action cache where the messages are typically very small.
Buildbarn can now fill all the gaps when writing, making storage more efficient.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="dag-shaped-blobaccess-configuration">DAG Shaped BlobAccess Configuration<a href="#dag-shaped-blobaccess-configuration" class="hash-link" aria-label="Direct link to DAG Shaped BlobAccess Configuration" title="Direct link to DAG Shaped BlobAccess Configuration">​</a></h2>
<p>Instead of a tree shaped BlobAccess configuration, the <code>with_labels</code> notation allows a directed acyclic graph.
See also the
<a href="https://github.com/buildbarn/bb-storage/commit/cc295adc0f05cd579d48a65325ce54b54331c6a6" target="_blank" rel="noopener noreferrer">bb-storage commit cc295ad</a>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="nfsv4-as-worker-filesystem">NFSv4 as worker filesystem<a href="#nfsv4-as-worker-filesystem" class="hash-link" aria-label="Direct link to NFSv4 as worker filesystem" title="Direct link to NFSv4 as worker filesystem">​</a></h2>
<p>The <code>bb_worker</code> can now supply the working directory for <code>bb_runner</code> using NFSv4.
Previously, FUSE and hard linking files from the worker cache were the only two options.
This addition was mainly done to overcome the poor FUSE support on macOS.</p>
<p>The NFSv4 server in <code>bb_worker</code> only supports macOS at the moment.
No effort has been spent to write custom mount logic for other systems yet.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="specify-forwardmetadata-with-a-jmespath">Specify <code>forwardMetadata</code> with a JMESPath<a href="#specify-forwardmetadata-with-a-jmespath" class="hash-link" aria-label="Direct link to specify-forwardmetadata-with-a-jmespath" title="Direct link to specify-forwardmetadata-with-a-jmespath">​</a></h2>
<p>Metadata forwarding is now more flexible, the JMESPath expressions can for example add authorization result data.
The format is described in
<a href="https://github.com/buildbarn/bb-storage/blob/0c2fcad5872b0fef47bb5bee8aba9518dc2fe465/pkg/proto/configuration/grpc/grpc.proto#L55-L93" target="_blank" rel="noopener noreferrer">grpc.proto</a>.</p>
<p>A common use case is to replace</p>
<div class="language-jsonnet codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-jsonnet codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    forwardMetadata: [&quot;build.bazel.remote.execution.v2.requestmetadata-bin&quot;],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>with</p>
<div class="language-jsonnet codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-jsonnet codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    addMetadataJmespathExpression: &#x27;{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;build.bazel.remote.execution.v2.requestmetadata-bin&quot;:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            incomingGRPCMetadata.&quot;build.bazel.remote.execution.v2.requestmetadata-bin&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="tracing-deprecate-the-jaeger-collector-span-exporter">Tracing: Deprecate the Jaeger collector span exporter<a href="#tracing-deprecate-the-jaeger-collector-span-exporter" class="hash-link" aria-label="Direct link to Tracing: Deprecate the Jaeger collector span exporter" title="Direct link to Tracing: Deprecate the Jaeger collector span exporter">​</a></h2>
<p>This option is deprecated, as Jaeger 1.35 and later provide native support for the OpenTelemetry protocol.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="bb-deployments-ubuntu-2204-example-runner-image"><code>bb-deployments</code> Ubuntu 22.04 Example Runner Image<a href="#bb-deployments-ubuntu-2204-example-runner-image" class="hash-link" aria-label="Direct link to bb-deployments-ubuntu-2204-example-runner-image" title="Direct link to bb-deployments-ubuntu-2204-example-runner-image">​</a></h2>
<p>The <a href="https://github.com/bazelbuild/bazel-toolchains/blob/4.0.0/rules/rbe_repo.bzl#L896" target="_blank" rel="noopener noreferrer">rbe_autoconfig</a>
in <a href="https://github.com/bazelbuild/bazel-toolchains" target="_blank" rel="noopener noreferrer">bazel-toolchains</a>
has been deprecated. In bb-deployments it has been replaced by the
<a href="https://github.com/nektos/act/blob/master/IMAGES.md" target="_blank" rel="noopener noreferrer">Act</a> image
<a href="https://github.com/catthehacker/docker_images" target="_blank" rel="noopener noreferrer">ghcr.io/catthehacker/ubuntu<!-- -->:act-22<!-- -->.04</a>,
distributed by <a href="https://github.com/catthehacker/docker_images" target="_blank" rel="noopener noreferrer">catthehacker</a>,
used for running GitHub Actions locally under Ubuntu 22.04.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="bb-deployments-integration-tests"><code>bb-deployments</code> Integration Tests<a href="#bb-deployments-integration-tests" class="hash-link" aria-label="Direct link to bb-deployments-integration-tests" title="Direct link to bb-deployments-integration-tests">​</a></h2>
<p>The <a href="https://github.com/buildbarn/bb-deployments/tree/ce123473f27290648d1e56f7072468eb6b67fefb/bare" target="_blank" rel="noopener noreferrer">bare deployment</a> and
<a href="https://github.com/buildbarn/bb-deployments/tree/ce123473f27290648d1e56f7072468eb6b67fefb/docker-compose" target="_blank" rel="noopener noreferrer">Docker Compose deployment</a>
have now got <a href="https://github.com/buildbarn/bb-deployments/tree/ce123473f27290648d1e56f7072468eb6b67fefb/tools" target="_blank" rel="noopener noreferrer">tests scripts</a>
that builds and tests <code>@abseil-hello//:hello_test</code> remotely, shuts down and then checks for 100% cache hit after restart.
Another CI test is checking for minimal differences between the Docker Compose deployment and
the <a href="https://github.com/buildbarn/bb-deployments/tree/ce123473f27290648d1e56f7072468eb6b67fefb/kubernetes" target="_blank" rel="noopener noreferrer">Kubernetes deployment</a>.</p>
<p>If there are any other changes you feel deserve a mention
feel free to submit a pull request at github using the link below.</p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/release/">release</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/buildbarn/">buildbarn</a></li></ul></div></footer></article><article class="margin-bottom--xl"><header><h2 class="title_f1Hy"><a href="/blog/bazel-6-errors-build-without-the-bytes/">Bazel 6 Errors when using Build without the Bytes</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2023-02-07T00:00:00.000Z">February 7, 2023</time> · <!-- -->4 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><img class="avatar__photo authorImage_XqGP" src="/img/benjamin-avatar.png" alt="Benjamin Ingberg"><div class="avatar__intro authorDetails_lV9A"><div class="avatar__name"><span class="authorName_yefp">Benjamin Ingberg</span></div><div class="authorSocials_rSDt"></div></div></div></div></div></header><div class="markdown"><p><em>** UPDATE: ** Bazel has a workaround for this issue
preventing the permanent build failure loop from 6.1.0 and
a proper fix with the introduction of
<a href="https://bazel.build/reference/command-line-reference#flag--experimental_remote_cache_ttl" target="_blank" rel="noopener noreferrer"><code>--experimental_remote_cache_ttl</code></a>
in Bazel 7</em></p>
<hr>
<p>Starting from v6.0.0, Bazel crashes when building without the bytes.
Because it sets <code>--experimental_action_cache_store_output_metadata</code>
when using <code>--remote_download_minimal</code> or <code>--remote_download_toplevel</code>.</p>
<p>Effectively this leads to Bazel getting stuck in a build failure loop
when your remote cache evicts an item you need from the cache.</p>
<div class="language-console codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-console codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">developer@machine:~$ bazel test @abseil-hello//:hello_test --remote_download_</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">minimal</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[0 / 6] [Prepa] BazelWorkspaceStatusAction stable-status.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ERROR: /home/developer/.cache/bazel/_bazel_developer/139b99b96c4ab6cba5122193</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1a36e346/external/abseil-hello/BUILD.bazel:26:8: Linking external/abseil-hell</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">o/hello_test failed: (Exit 34): 42 errors during bulk transfer:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">java.io.FileNotFoundException: /home/developer/.cache/bazel/_bazel_developer/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">139b99b96c4ab6cba51221931a36e346/execroot/cache_test/bazel-out/k8-fastbuild/b</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">in/external/com_google_absl/absl/base/_objs/base/spinlock.pic.o (No such file</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> or directory)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Target @abseil-hello//:hello_test failed to build</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Use --verbose_failures to see the command lines of failed build steps.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">INFO: Elapsed time: 3.820s, Critical Path: 0.88s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">INFO: 5 processes: 4 internal, 1 remote.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">FAILED: Build did NOT complete successfully</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@abseil-hello//:hello_test                                   FAILED TO BUILD</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The key here is <strong>(Exit 34): xx errors during bulk transfer</strong>.
34 is Bazel&#x27;s error code for Remote Error.</p>
<p>The recommended solution is to set the flag explicitly to false,
with <code>--experimental_action_cache_store_output_metadata=false</code>.
To quickly solve the issue on your local machine you can run <code>bazel clean</code>.
However, this will just push the error into the future.</p>
<p>The bug is independent of which remote cache system you use
and is tracked at <a href="https://github.com/bazelbuild/bazel/issues/17366" target="_blank" rel="noopener noreferrer">GitHub</a>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="background">Background<a href="#background" class="hash-link" aria-label="Direct link to Background" title="Direct link to Background">​</a></h2>
<p>When performing an analysis of what to build
Bazel will ask the remote cache which items have already been built.
Bazel will only schedule build actions for items
that do not already exist in the cache.
If running a build without the bytes<sup><a href="#user-content-fn-1-13c049" id="user-content-fnref-1-13c049" data-footnote-ref="true" aria-describedby="footnote-label">1</a></sup>
the intermediary results will not be downloaded to the client.</p>
<p>Should the cached items be evicted
then Bazel will run into an unrecoverable error.
It wants the remote system to perform an action using inputs from the cache,
but they have disappeared.
And Bazel can not upload them,
as they were never downloaded to the client.
The build would then dutifully crash
(some work has been put into trying to
<a href="https://groups.google.com/g/bazel-dev/c/WwNN4kiYSpc" target="_blank" rel="noopener noreferrer">resolve this on the bazel side</a>
but it has not been considered a priority).</p>
<p>This puts an implicit requirement on the remote cache implementation.
Artifacts need to be saved for as long as Bazel needs them.
The problem here is that this is an undefined period of time.
Bazel will not proactively check if the item still exists,
nor in any other manner inform the cache that
it will need the item in the future.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="before-v600">Before v6.0.0<a href="#before-v600" class="hash-link" aria-label="Direct link to Before v6.0.0" title="Direct link to Before v6.0.0">​</a></h2>
<p>Bazel tied the lifetime of which items already exists in the cache
(the existence cache)
to the analysis cache.
Whenever the analysis cache was purged it would also drop the existence cache.</p>
<p>The analysis cache is purged quite frequently.
It would therefore be rare in practice,
that the existence cache would be out of date.
Furthermore, since the existence cache was an in-memory cache,
Bazel crashing would forcefully evict the existence cache.
Thereby fixing the issue.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="after-v600">After v6.0.0<a href="#after-v600" class="hash-link" aria-label="Direct link to After v6.0.0" title="Direct link to After v6.0.0">​</a></h2>
<p>With the
<code>--experimental_action_cache_store_output_metadata</code> flag enabled by default
the existence cache is instead committed to disk and
never dropped during normal operation.</p>
<p>This means two things:</p>
<ol>
<li>The implied requirement on the remote cache is effectively infinite.</li>
<li>Should this requirement not be met the build will fail.
And since the existence cache is committed to disk Bazel will just
fail again the next time you run it.</li>
</ol>
<p>Currently the only user-facing way of purging the existence cache
is to run <code>bazel clean</code>.
Which is generally considered an anti-pattern.</p>
<p>If you are using the <a href="https://github.com/buildbarn/bb-clientd#-to-perform-remote-builds-without-the-bytes" target="_blank" rel="noopener noreferrer">bb-clientd</a> <code>--remote_output_service</code>
to run builds without the bytes
(an alternative strategy to <code>--remote_download_minimal</code>)
this will not affect you.</p>
<!-- -->
<section data-footnotes="true" class="footnotes"><h2 class="anchor anchorWithStickyNavbar_LWe7 sr-only" id="footnote-label">Footnotes<a href="#footnote-label" class="hash-link" aria-label="Direct link to Footnotes" title="Direct link to Footnotes">​</a></h2>
<ol>
<li id="user-content-fn-1-13c049">
<p>When using Bazel with remote execution
remote builds are run in a remote server cluster.
There is therefore no need for each developer
to download the partial results of build.
Bazel calls this feature
<a href="https://blog.bazel.build/2019/05/07/builds-without-bytes.html" target="_blank" rel="noopener noreferrer">Remote Builds Without the Bytes</a>.
The progress of the feature can be tracked at
<a href="https://github.com/bazelbuild/bazel/issues/6862" target="_blank" rel="noopener noreferrer">GitHub</a>. <a href="#user-content-fnref-1-13c049" data-footnote-backref="" aria-label="Back to reference 1" class="data-footnote-backref">↩</a></p>
</li>
</ol>
</section></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/bazel/">bazel</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/bugs/">bugs</a></li></ul></div></footer></article><article class="margin-bottom--xl"><header><h2 class="title_f1Hy"><a href="/blog/buildbar-at-meroton-office/">BuildBar at the Meroton Office</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2022-11-24T00:00:00.000Z">November 24, 2022</time> · <!-- -->One min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><img class="avatar__photo authorImage_XqGP" src="/img/benjamin-avatar.png" alt="Benjamin Ingberg"><div class="avatar__intro authorDetails_lV9A"><div class="avatar__name"><span class="authorName_yefp">Benjamin Ingberg</span></div><div class="authorSocials_rSDt"></div></div></div></div></div></header><div class="markdown"><p>After BazelCon we&#x27;ve all gotten a bit giddy and you might feel excited how the information presented at BazelCon might impact your development workflow.
For that purpose we&#x27;re inviting everyone in the wider bazel community to an open BuildBar at the Meroton offices.</p>
<p>Come over and digest BazelCon with high level technical discussions of the talks,
great company, a pleasant atmosphere and also beer.</p>
<p>Feel welcome to come over this Thursday the first of December from 16 to 20.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="directions">Directions<a href="#directions" class="hash-link" aria-label="Direct link to Directions" title="Direct link to Directions">​</a></h2>
<p>You&#x27;ll find us at our Linköping offices at Fridtunagatan 33. Currently there is some construction but follow the red lines and you&#x27;ll be fine.</p>
<figure><img alt="" src="/img/office_map.webp"><figcaption>Fridtunagatan 33 Linköping</figcaption></figure></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/meroton/">meroton</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/afterwork/">afterwork</a></li></ul></div></footer></article><article class="margin-bottom--xl"><header><h2 class="title_f1Hy"><a href="/blog/remote-executors-for-free-tier/">Remote Executors for the Free Environment</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2022-10-13T00:00:00.000Z">October 13, 2022</time> · <!-- -->2 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><img class="avatar__photo authorImage_XqGP" src="/img/benjamin-avatar.png" alt="Benjamin Ingberg"><div class="avatar__intro authorDetails_lV9A"><div class="avatar__name"><span class="authorName_yefp">Benjamin Ingberg</span></div><div class="authorSocials_rSDt"></div></div></div></div></div></header><div class="markdown"><p>We&#x27;ve performed some updates to the free tier and our pricing model.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="shared-cache">Shared Cache<a href="#shared-cache" class="hash-link" aria-label="Direct link to Shared Cache" title="Direct link to Shared Cache">​</a></h2>
<p>The free tier has been upgraded into an environment with a 1TB cache.
This means that you can use the free tier without worrying about hitting any limits or setup process.</p>
<p>Do note that while the cached items will only be accessible with the correct api keys,
the storage area can be reclaimed by anyone.
I.e. as the cache becomes full your items might be dropped.</p>
<p>With the current churn we expect any items in the cache last at least a week.
However, you should always treat items in the cache as something which might be dropped at any moment.
The purpose and design of the cache is to maximize build performance, not to provide storage.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="shared-executors">Shared executors<a href="#shared-executors" class="hash-link" aria-label="Direct link to Shared executors" title="Direct link to Shared executors">​</a></h2>
<p>New for the free environment is the introduction of remote execution,
this was previously only available for paying customers.</p>
<p>If you&#x27;re using bazel you can simply add the <code>--remote_executor=&lt;...&gt;</code> flag and your builds will be done remotely.</p>
<p>The free environment has access to 64 shared executors.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="starter-tier">Starter tier<a href="#starter-tier" class="hash-link" aria-label="Direct link to Starter tier" title="Direct link to Starter tier">​</a></h2>
<p>If you need dedicated storage for evaluation purposes we also offer a starter tier.
The starter tier is a streamlined environment with 100 GB of dedicated cache and access to the same 64 executors as the free tier.</p>
<p>This allows you to try out remote execution and caching without being disturbed by others.
While the 100GB dedicated cache will only be used by you and therefore not be overwritten by anyone else&#x27;s build,
the cache is still a cache and the system will still drop the cache entries if it determines it is useful for maximizing performance.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="need-more-executors">Need more executors?<a href="#need-more-executors" class="hash-link" aria-label="Direct link to Need more executors?" title="Direct link to Need more executors?">​</a></h2>
<p>At the moment the starter tier has a fixed amount of shared executors.
If you need a scalable solution contact us for setting up a custom Buildbarn environment of any size.</p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/meroton/">meroton</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/remote-execution/">remote execution</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/cloud/">cloud</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/free-tier/">free tier</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/starter-tier/">starter tier</a></li></ul></div></footer></article><article class="margin-bottom--xl"><header><h2 class="title_f1Hy"><a href="/blog/tips-trix-and-nondeterminism/">Tips, Tricks &amp; Non-Deterministic Builds</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2022-08-28T00:00:00.000Z">August 28, 2022</time> · <!-- -->2 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><img class="avatar__photo authorImage_XqGP" src="/img/benjamin-avatar.png" alt="Benjamin Ingberg"><div class="avatar__intro authorDetails_lV9A"><div class="avatar__name"><span class="authorName_yefp">Benjamin Ingberg</span></div><div class="authorSocials_rSDt"></div></div></div></div></div></header><div class="markdown"><p>When you have a remote build and cache cluster it can sometimes be hard to track down what exactly is using all of your building resources. To help with this we have started a tips and trix section in the documentation where we will share methods we use to debug and resolve slow builds.</p>
<p>The first section is about build non-determinism. Ideally your build actions should produce the same output when run with the same input, in practice this is sometimes not the case. If you are lucky a non-deterministic action won&#x27;t be noticed since the inputs for the non-deterministic action is unchanged it won&#x27;t be rebuilt.</p>
<p>If you&#x27;re not so lucky the non-determinism stems from a bug in the implementation and you should definitely pay attention to them. But how do you know which if any actions are non-deterministic?</p>
<p>This is not trivial but we have added <a href="/docs/tips/non-deterministic-builds/">a server side feature</a> which allows detection of non-determinism with virtually no effort on your part.</p>
<p>Once activated it reruns a configured fraction of your actions and automatically flags them if they produce different outputs. The scheduling is done outside of your bazel invocation so your build throughput will be unaffected at the cost of an increase in the number of resources consumed. We suggest 1% which will only increase your resource use by a trivial amount but you could of course set it to 100% which would double the cost of your builds.</p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/meroton/">meroton</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/bazel/">bazel</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/optimizing/">optimizing</a></li></ul></div></footer></article><article class="margin-bottom--xl"><header><h2 class="title_f1Hy"><a href="/blog/bb-deploy-updates-2022-04/">Updates to Buildbarn deployment repo as of April 2022</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2022-05-04T00:00:00.000Z">May 4, 2022</time> · <!-- -->2 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><img class="avatar__photo authorImage_XqGP" src="/img/benjamin-avatar.png" alt="Benjamin Ingberg"><div class="avatar__intro authorDetails_lV9A"><div class="avatar__name"><span class="authorName_yefp">Benjamin Ingberg</span></div><div class="authorSocials_rSDt"></div></div></div></div></div></header><div class="markdown"><p>The <a href="https://github.com/buildbarn/bb-deployments" target="_blank" rel="noopener noreferrer">sample configuration project for Buildbarn</a> was recently updated after a long hiatus. As an aid for people to understand which changes have been done see the following high level summary.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="april-2022-updates">April 2022 Updates<a href="#april-2022-updates" class="hash-link" aria-label="Direct link to April 2022 Updates" title="Direct link to April 2022 Updates">​</a></h2>
<p>This includes updates to Buildbarn since December 2020.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="authorizer-overhaul">Authorizer Overhaul<a href="#authorizer-overhaul" class="hash-link" aria-label="Direct link to Authorizer Overhaul" title="Direct link to Authorizer Overhaul">​</a></h3>
<p>Authorizers have been rehauled to be more flexible it is now part of each individual cache and execution configuration.</p>
<p>Using a JWT authorization bearer token has been added as an authorization method.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="hierarchical-blob-access">Hierarchical Blob Access<a href="#hierarchical-blob-access" class="hash-link" aria-label="Direct link to Hierarchical Blob Access" title="Direct link to Hierarchical Blob Access">​</a></h3>
<p>Using hierarchical blob access allows blobs in instance name <code>foo/bar</code> to be accessed from instance <code>foo/bar/baz</code> but not instance <code>foo</code> or <code>foo/qux</code>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="action-result-expiration">Action Result Expiration<a href="#action-result-expiration" class="hash-link" aria-label="Direct link to Action Result Expiration" title="Direct link to Action Result Expiration">​</a></h3>
<p>An expiry can be added to action result which lets the action cache purge the result of an exection that was performed too far in the past. This can be used to ensure that all targets are rebuilt periodically even if they are accessed frequently enough to not normally be purged from the cache.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="read-only-cache-replicas">Read Only Cache Replicas<a href="#read-only-cache-replicas" class="hash-link" aria-label="Direct link to Read Only Cache Replicas" title="Direct link to Read Only Cache Replicas">​</a></h3>
<p>Cache read traffic can now be sent to a read-only replica which is periodically probed for availability.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="concurrency-limiting-blob-replication">Concurrency Limiting Blob Replication<a href="#concurrency-limiting-blob-replication" class="hash-link" aria-label="Direct link to Concurrency Limiting Blob Replication" title="Direct link to Concurrency Limiting Blob Replication">​</a></h3>
<p>Limit the number of concurrent replications to prevent network starvation</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="run-commands-as-another-user">Run Commands as Another User<a href="#run-commands-as-another-user" class="hash-link" aria-label="Direct link to Run Commands as Another User" title="Direct link to Run Commands as Another User">​</a></h3>
<p>Allows the commands to be run as a different user, on most platforms this means the bb-runner instance must run as root.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="size-class-analysis">Size Class Analysis<a href="#size-class-analysis" class="hash-link" aria-label="Direct link to Size Class Analysis" title="Direct link to Size Class Analysis">​</a></h3>
<p>Allows executors of different size classes to be used, the scheduler will attempt to utilize executors efficiently but there is an inherent tradeof between throughput and latency. Once configured the scheduler will automatically attempt to keep track of which actions are best run on which executors.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="execution-routing-policy">Execution Routing Policy<a href="#execution-routing-policy" class="hash-link" aria-label="Direct link to Execution Routing Policy" title="Direct link to Execution Routing Policy">​</a></h3>
<p>The scheduler accepts an execution routing policy configuration that allows it to determine how to defer builds to different executors.</p>
<p>If you see any other changes you feel should get a mention feel free to submit a pull request at github using the link below.</p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/release/">release</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/buildbarn/">buildbarn</a></li></ul></div></footer></article><article class="margin-bottom--xl"><header><h2 class="title_f1Hy"><a href="/blog/about/">Purpose of the Articles</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2022-02-22T00:00:00.000Z">February 22, 2022</time> · <!-- -->One min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><img class="avatar__photo authorImage_XqGP" src="/img/benjamin-avatar.png" alt="Benjamin Ingberg"><div class="avatar__intro authorDetails_lV9A"><div class="avatar__name"><span class="authorName_yefp">Benjamin Ingberg</span></div><div class="authorSocials_rSDt"></div></div></div></div></div></header><div class="markdown"><p>The purpose of these articles is to have a freeform area discussing ideas, technical issues, solutions and news in an indepth relaxed manner. It is not to serve as reference material, structured reference material should be available in the documentation section.</p>
<p>The article format allows more in depth on discussions for reacurring subjects. In contrast to the documentation published articles aren&#x27;t changed, if the subject requires a revisit in the future then we publish a new post and add references to the old.</p>
<p>If you see any errors feel free to submit a pull request at github using the link below.</p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/blog/tags/meroton/">meroton</a></li></ul></div></footer></article><nav class="pagination-nav" aria-label="Blog list page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/blog/"><div class="pagination-nav__label">Newer entries</div></a></nav></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/intro/">Introduction</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/theory/components-of-a-build/">Theory</a></li></ul></div><div class="col footer__col"><div class="footer__title">About Us</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/services/">Services</a></li><li class="footer__item"><a class="footer__link-item" href="/contact/">Contact</a></li><li class="footer__item"><a href="https://forms.gle/wchwDu6roWg6A7U29" target="_blank" rel="noopener noreferrer" class="footer__link-item">Sign up<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" href="/master-thesis/">Master Thesis</a></li></ul></div><div class="col footer__col"><div class="footer__title">Hosted build system</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/services/self-hosted/">Self hosted</a></li><li class="footer__item"><a class="footer__link-item" href="/services/cloud-environment/">Cloud based</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog/">Blog</a></li><li class="footer__item"><a class="footer__link-item" href="/bug-bounty/">Bug bounty</a></li><li class="footer__item"><a class="footer__link-item" href="/privacy-policy/">Privacy Policy</a></li><li class="footer__item"><a href="https://github.com/meroton" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Meroton AB</div></div></div></footer></div>
</body>
</html>