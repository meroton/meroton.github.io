<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.15">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title=" RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title=" Atom Feed">
<link rel="alternate" type="application/json" href="/blog/feed.json" title=" JSON Feed">
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-LVF8V72WEQ"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-LVF8V72WEQ",{anonymize_ip:!0})</script><title data-react-helmet="true">Updates to Buildbarn deployment repo | Meroton</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://meroton.github.io/blog/bb-deploy-updates-2022-04/"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_tag" content="default"><meta data-react-helmet="true" property="og:title" content="Updates to Buildbarn deployment repo | Meroton"><meta data-react-helmet="true" name="description" content="The sample configuration project for Buildbarn was recently updated after a long hiatus. As an aid for people to understand which changes have been done see the following high level summary."><meta data-react-helmet="true" property="og:description" content="The sample configuration project for Buildbarn was recently updated after a long hiatus. As an aid for people to understand which changes have been done see the following high level summary."><meta data-react-helmet="true" property="og:type" content="article"><meta data-react-helmet="true" property="article:published_time" content="2022-05-04T00:00:00.000Z"><meta data-react-helmet="true" property="article:tag" content="meroton,release,buildbarn"><link data-react-helmet="true" rel="icon" href="/img/favicon.svg"><link data-react-helmet="true" rel="canonical" href="https://meroton.github.io/blog/bb-deploy-updates-2022-04/"><link data-react-helmet="true" rel="alternate" href="https://meroton.github.io/blog/bb-deploy-updates-2022-04/" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://meroton.github.io/blog/bb-deploy-updates-2022-04/" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.c319aca5.css">
<link rel="preload" href="/assets/js/runtime~main.160b6119.js" as="script">
<link rel="preload" href="/assets/js/main.20c25a17.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="Meroton" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/img/logo.svg" alt="Meroton" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title">Meroton</b></a><a class="navbar__item navbar__link" href="/docs/intro/">Documentation</a><a class="navbar__item navbar__link" href="/services/">Services</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog/">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://forms.gle/wchwDu6roWg6A7U29" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>Sign up<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_Pssr toggle_TdHA toggleDisabled_jDku"><div class="toggleTrack_SSoT" role="button" tabindex="-1"><div class="toggleTrackCheck_XobZ"><span class="toggleIcon_eZtF">ðŸŒœ</span></div><div class="toggleTrackX_YkSC"><span class="toggleIcon_eZtF">ðŸŒž</span></div><div class="toggleTrackThumb_uRm4"></div></div><input type="checkbox" class="toggleScreenReader_JnkT" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper blog-wrapper blog-post-page"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_a9qW thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_uKok margin-bottom--md">All articles</div><ul class="sidebarItemList_Kvuv"><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/blog/remote-executors-for-free-tier/">Remote Executors for the Free Environment</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/blog/tips-trix-and-nondeterminism/">Tips, Tricks &amp; Non-Deterministic Builds</a></li><li class="sidebarItem_CF0Q"><a aria-current="page" class="sidebarItemLink_miNk sidebarItemLinkActive_RRTD" href="/blog/bb-deploy-updates-2022-04/">Updates to Buildbarn deployment repo</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/blog/about/">Purpose of the Articles</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h1 class="blogPostTitle_rzP5" itemprop="headline">Updates to Buildbarn deployment repo</h1><div class="blogPostData_Zg1s margin-vert--md"><time datetime="2022-05-04T00:00:00.000Z" itemprop="datePublished">May 4, 2022</time> Â· <!-- -->2 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_FlmR"><div class="avatar margin-bottom--sm"><a class="avatar__photo-link avatar__photo"><img class="image_o0gy" src="/img/benjamin-avatar.png" alt="Benjamin Ingberg"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a itemprop="url"><span itemprop="name">Benjamin Ingberg</span></a></div></div></div></div></div></header><div id="post-content" class="markdown" itemprop="articleBody"><p>The <a href="https://github.com/buildbarn/bb-deployments" target="_blank" rel="noopener noreferrer">sample configuration project for Buildbarn</a> was recently updated after a long hiatus. As an aid for people to understand which changes have been done see the following high level summary.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="april-2022-updates">April 2022 Updates<a class="hash-link" href="#april-2022-updates" title="Direct link to heading">â€‹</a></h2><p>This includes updates to Buildbarn since December 2020.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="authorizer-overhaul">Authorizer Overhaul<a class="hash-link" href="#authorizer-overhaul" title="Direct link to heading">â€‹</a></h3><p>Authorizers have been rehauled to be more flexible it is now part of each individual cache and execution configuration.</p><p>Using a JWT authorization bearer token has been added as an authorization method.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="hierarchical-blob-access">Hierarchical Blob Access<a class="hash-link" href="#hierarchical-blob-access" title="Direct link to heading">â€‹</a></h3><p>Using hierarchical blob access allows blobs in instance name <code>foo/bar</code> to be accessed from instance <code>foo/bar/baz</code> but not instance <code>foo</code> or <code>foo/qux</code>.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="action-result-expiration">Action Result Expiration<a class="hash-link" href="#action-result-expiration" title="Direct link to heading">â€‹</a></h3><p>An expiry can be added to action result which lets the action cache purge the result of an exection that was performed too far in the past. This can be used to ensure that all targets are rebuilt periodically even if they are accessed frequently enough to not normally be purged from the cache.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="read-only-cache-replicas">Read Only Cache Replicas<a class="hash-link" href="#read-only-cache-replicas" title="Direct link to heading">â€‹</a></h3><p>Cache read traffic can now be sent to a read-only replica which is periodically probed for availability.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="concurrency-limiting-blob-replication">Concurrency Limiting Blob Replication<a class="hash-link" href="#concurrency-limiting-blob-replication" title="Direct link to heading">â€‹</a></h3><p>Limit the number of concurrent replications to prevent network starvation</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="run-commands-as-another-user">Run Commands as Another User<a class="hash-link" href="#run-commands-as-another-user" title="Direct link to heading">â€‹</a></h3><p>Allows the commands to be run as a different user, on most platforms this means the bb-runner instance must run as root.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="size-class-analysis">Size Class Analysis<a class="hash-link" href="#size-class-analysis" title="Direct link to heading">â€‹</a></h3><p>Allows executors of different size classes to be used, the scheduler will attempt to utilize executors efficiently but there is an inherent tradeof between throughput and latency. Once configured the scheduler will automatically attempt to keep track of which actions are best run on which executors.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="execution-routing-policy">Execution Routing Policy<a class="hash-link" href="#execution-routing-policy" title="Direct link to heading">â€‹</a></h3><p>The scheduler accepts an execution routing policy configuration that allows it to determine how to defer builds to different executors.</p><p>If you see any other changes you feel should get a mention feel free to submit a pull request at github using the link below.</p></div><footer class="row docusaurus-mt-lg blogPostDetailsFull_h6_j"><div class="col"><b>Tags:</b><ul class="tags_XVD_ padding--none margin-left--sm"><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/blog/tags/meroton/">meroton</a></li><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/blog/tags/release/">release</a></li><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/blog/tags/buildbarn/">buildbarn</a></li></ul></div><div class="col margin-top--sm"><a href="https://github.com/meroton/docs/edit/main/blog/2022-05-04-updates-to-bb-deploy.mdx" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_dcUD" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/blog/tips-trix-and-nondeterminism/"><div class="pagination-nav__sublabel">Newer Post</div><div class="pagination-nav__label">Tips, Tricks &amp; Non-Deterministic Builds</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/blog/about/"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">Purpose of the Articles</div></a></div></nav></main><div class="col col--2"><div class="tableOfContents_cNA8 thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#april-2022-updates" class="table-of-contents__link toc-highlight">April 2022 Updates</a><ul><li><a href="#authorizer-overhaul" class="table-of-contents__link toc-highlight">Authorizer Overhaul</a></li><li><a href="#hierarchical-blob-access" class="table-of-contents__link toc-highlight">Hierarchical Blob Access</a></li><li><a href="#action-result-expiration" class="table-of-contents__link toc-highlight">Action Result Expiration</a></li><li><a href="#read-only-cache-replicas" class="table-of-contents__link toc-highlight">Read Only Cache Replicas</a></li><li><a href="#concurrency-limiting-blob-replication" class="table-of-contents__link toc-highlight">Concurrency Limiting Blob Replication</a></li><li><a href="#run-commands-as-another-user" class="table-of-contents__link toc-highlight">Run Commands as Another User</a></li><li><a href="#size-class-analysis" class="table-of-contents__link toc-highlight">Size Class Analysis</a></li><li><a href="#execution-routing-policy" class="table-of-contents__link toc-highlight">Execution Routing Policy</a></li></ul></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/intro/">Introduction</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/theory/components-of-a-build/">Theory</a></li></ul></div><div class="col footer__col"><div class="footer__title">About Us</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/services/">Services</a></li><li class="footer__item"><a class="footer__link-item" href="/contact/">Contact</a></li><li class="footer__item"><a href="https://forms.gle/wchwDu6roWg6A7U29" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Sign up<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">Hosted build system</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/services/self-hosted/">Self hosted</a></li><li class="footer__item"><a class="footer__link-item" href="/services/cloud-environment/">Cloud based</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/blog/">Blog</a></li><li class="footer__item"><a href="https://github.com/meroton" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2022 Meroton AB</div></div></div></footer></div>
<script src="/assets/js/runtime~main.160b6119.js"></script>
<script src="/assets/js/main.20c25a17.js"></script>
</body>
</html>