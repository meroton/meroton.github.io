<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.15">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title=" RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title=" Atom Feed">
<link rel="alternate" type="application/json" href="/blog/feed.json" title=" JSON Feed">
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-LVF8V72WEQ"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-LVF8V72WEQ",{anonymize_ip:!0})</script><title data-react-helmet="true">Components of a Build | Meroton</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://meroton.github.io/docs/theory/components-of-a-build/"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Components of a Build | Meroton"><meta data-react-helmet="true" name="description" content="A build is a pretty abstract concept, for many developers it&#x27;s what happens when you press f5 but before your application starts. So what does happen when you press f5? Well that depends on your underlying environment, but in general it runs a couple of actions."><meta data-react-helmet="true" property="og:description" content="A build is a pretty abstract concept, for many developers it&#x27;s what happens when you press f5 but before your application starts. So what does happen when you press f5? Well that depends on your underlying environment, but in general it runs a couple of actions."><link data-react-helmet="true" rel="icon" href="/img/favicon.svg"><link data-react-helmet="true" rel="canonical" href="https://meroton.github.io/docs/theory/components-of-a-build/"><link data-react-helmet="true" rel="alternate" href="https://meroton.github.io/docs/theory/components-of-a-build/" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://meroton.github.io/docs/theory/components-of-a-build/" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.008b11e2.css">
<link rel="preload" href="/assets/js/runtime~main.57923227.js" as="script">
<link rel="preload" href="/assets/js/main.637de252.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="Meroton" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/img/logo.svg" alt="Meroton" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title">Meroton</b></a><a class="navbar__item navbar__link navbar__link--active" href="/docs/intro/">Documentation</a><a class="navbar__item navbar__link" href="/services/">Services</a><a class="navbar__item navbar__link" href="/blog/">Blog</a></div><div class="navbar__items navbar__items--right"><div class="toggle_Pssr toggle_TdHA toggleDisabled_jDku"><div class="toggleTrack_SSoT" role="button" tabindex="-1"><div class="toggleTrackCheck_XobZ"><span class="toggleIcon_eZtF">ðŸŒœ</span></div><div class="toggleTrackX_YkSC"><span class="toggleIcon_eZtF">ðŸŒž</span></div><div class="toggleTrackThumb_uRm4"></div></div><input type="checkbox" class="toggleScreenReader_JnkT" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_P2Lg"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_RiI4" type="button"></button><aside class="theme-doc-sidebar-container docSidebarContainer_rKC_"><div class="sidebar_CW9Y"><nav class="menu thin-scrollbar menu_SkdO"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro/">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active hasHref_VCh3" aria-current="page" href="/docs/theory/components-of-a-build/">Theory</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/theory/components-of-a-build/">Components of a Build</a></li></ul></li></ul></nav></div></aside><main class="docMainContainer_TCnq"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_DM6M"><div class="docItemContainer_vinB"><article><div class="tocCollapsible_jdIR theme-doc-toc-mobile tocMobile_TmEX"><button type="button" class="clean-btn tocCollapsibleButton_Fzxq">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Components of a Build</h1><p>A build is a pretty abstract concept, for many developers it&#x27;s what happens when you press <code>f5</code> but before your application starts. So what does happen when you press <code>f5</code>? Well that depends on your underlying environment, but in general it runs a couple of actions.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="what-is-an-action">What is an Action?<a class="hash-link" href="#what-is-an-action" title="Direct link to heading">â€‹</a></h2><p>An action is something that takes input and produces output, an example of a simple action could be described by the command <code>cpÂ example.txtÂ example-copy.txt</code> which executes the executable <code>cp</code> with <code>example.txt</code> as its input and creates <code>example-copy.txt</code> as its output.</p><p>For a more relevant but still small example consider the following <code>C</code> project which consists of a static library <code>lib</code> and a <code>main.c</code> file consuming that library.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">// main.c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#include &quot;lib.h&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">void main() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  hello();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">---</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// lib.h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">void hello();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">void world();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">---</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// lib.c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#include &quot;lib.h&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#include &quot;stdio.h&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">void hello() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  printf(&quot;Hello &quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">void world() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  printf(&quot;World!);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>We can compile this project with these 4 commands each representing an action</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain"> $&gt; cc -c -o lib.o lib.c      # compile library into object file</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $&gt; ar rcs lib.a lib.o        # turn library object files into a static library (an archive)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $&gt; cc -c -o main.o main.c    # compile main.c into an object file</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> $&gt; cc main.o lib.a -o main   # link our library and our object file into an executable</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="incremental-builds">Incremental Builds<a class="hash-link" href="#incremental-builds" title="Direct link to heading">â€‹</a></h2><p>The previous actions can be displayed with this dependency graph<sup><a href="#note-1">1</a></sup></p><a href="#note-1" title="Simplified dependency graph for our example"><figure><img alt="" src="/img/dependency_graph.drawio.svg"><figcaption></figcaption></figure></a><p>If we make a small modification to the <code>main.c</code> file</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">// main.c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#include &quot;lib.h&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">void main() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  hello();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  world();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Then we only have to perform two actions, recompiling the <code>main.c</code> file and relinking (this is what is usually called an incremental build).</p><a title="Incremental build graph for our example"><figure><img alt="" src="/img/dependency_graph_incremental.drawio.svg"><figcaption></figcaption></figure></a><p>A lot of developers have issues with their incremental builds where they are not stable, therefore requiring a clean build before building again. There are a few common reasons this would happen:</p><ol><li>Race conditions, files can be modified during the build leading to some files incorrectly being consided unchanged since the last build</li><li>Imperfect method of checking for changes, such as comparing timestamps of the files instead of the content</li><li>Changed but unspecified dependencies, happens when your dependency graph is incomplete</li></ol><p>In a large project the vast majority of files will be untouched in between two different builds, therefore developers can expect a huge performance increase by by making sure that the incremental builds work correctly, as well as saving them a lot of headaches about peculiar bugs happening randomly.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="deterministic-compilations">Deterministic Compilations<a class="hash-link" href="#deterministic-compilations" title="Direct link to heading">â€‹</a></h2><p>The dependency graph helps us figure out which actions might need to be rerun, but sometimes an action might result in the same result as before. In that case we wouldn&#x27;t want unnecessary actions to run further down in the tree.</p><p>Consider the case where we add a comment to our header file, documenting what the code does.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">// lib.h</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Prints &quot;Hello&quot; to the standard output</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">void hello();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Studying our dependency graph we see that we need to compilate of <code>lib.o</code> as well as a compilation of <code>main.o</code> the output of those compilations do not change. This means the creation of a static library and the linking step can be short-circuited and the result of the previous compilation returned instead.</p><a title="Short-circuited incremental build graph for our example"><figure><img alt="" src="/img/dependency_graph_short_circuited.drawio.svg"><figcaption></figcaption></figure></a><p>This works because our build step is reproducible (often called a deterministic build), running it several times produces the exact same output. For the vast majority of software this is the intended behaviour. There are several advantages to having reproducible builds and there are very few valid reasons not to. However, sometimes the world doesn&#x27;t work the way we want it to and fixing the issue is outside of our power, perhaps a piece of third party software is adding random timestamps or ids to the output. At those times you can often ignore the issue, try to move the non-determinism away from hot paths is your code so as to minimize the amount of wasted effort.</p><p>If you purposefully want the output to be non-deterministic it is better to add a dependency to a random source than to introduce it in your codebase, i.e. have the current time or a random seed as a dependency.</p><hr><span id="note-1">Note 1:</span><p>As a simplification we do not illustrate the implied action dependencies. I.e. <code>main.o</code> is not dependent on <code>main.c</code> or <code>lib.h</code> but only on the action described by <code>cc -c main.c -o main.o</code> which in turn is dependent on <code>main.c</code> and <code>lib.h</code>.</p><p>There are also a few implied dependencies here, notably the compiler, the c-standard library and its header files (usually located in <code>/usr/include</code>) as well as a few implied flags about compilation target. This is rarely a problem for the standard library but when you include more esoteric libraries version incompatibilities will rear its ugly head. This entire class of problem can be eliminated by containerizing our builds, i.e. the compilation is run by a well defined compiler inside a container, the container becomes part of the dependency graph and any forgotten dependencies will become immediately apparent (since the container wont know of them).</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/meroton/docs/edit/main/docs/theory/components-of-a-build.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_dcUD" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_foO9"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/intro/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Introduction</div></a></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div><div class="col col--3"><div class="tableOfContents_cNA8 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#what-is-an-action" class="table-of-contents__link toc-highlight">What is an Action?</a></li><li><a href="#incremental-builds" class="table-of-contents__link toc-highlight">Incremental Builds</a></li><li><a href="#deterministic-compilations" class="table-of-contents__link toc-highlight">Deterministic Compilations</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/intro/">Introduction</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/theory/components-of-a-build/">Theory</a></li></ul></div><div class="col footer__col"><div class="footer__title">About Us</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/services/">Services</a></li><li class="footer__item"><a class="footer__link-item" href="/contact/">Contact</a></li></ul></div><div class="col footer__col"><div class="footer__title">Hosted build system</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/services/self-hosted/">Self hosted</a></li><li class="footer__item"><a class="footer__link-item" href="/services/cloud-environment/">Cloud based</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/blog/">Blog</a></li><li class="footer__item"><a href="https://github.com/meroton" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2022 Meroton Inc.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.57923227.js"></script>
<script src="/assets/js/main.637de252.js"></script>
</body>
</html>